services:
    goc:
        healthcheck:
            interval: 1s
            retries: 10
            test:
                - CMD-SHELL
                - curl -O /dev/null http://localhost:7777 || exit 1
            timeout: 5s
        hostname: goc
        image: goc-server:latest
        ports:
            - 7777:7777
        volumes:
            - /apsarapangu/SSDCache1/ilogtail/test/e2e/report/input_mock_log_coverage.out:/coverage.log
    ilogtailC:
        environment:
            - LOGTAIL_FORCE_COLLECT_SELF_TELEMETRY=true
            - LOGTAIL_DEBUG_FLAG=true
            - LOGTAIL_AUTO_PROF=false
            - LOGTAIL_HTTP_LOAD_CONFIG=true
            - ALICLOUD_LOG_DOCKER_ENV_CONFIG=true
            - ALICLOUD_LOG_PLUGIN_ENV_CONFIG=false
            - ALIYUN_LOGTAIL_USER_DEFINED_ID=1111
        healthcheck:
            interval: 15s
            test: cat /ilogtail/ilogtail.LOG
            timeout: 5s
        hostname: ilogtail
        image: aliyun/ilogtail:2.0.0
        pid: host
        ports:
            - 18689:18689
            - 18086:18086
        privileged: true
        volumes:
            - /apsarapangu/SSDCache1/ilogtail/test/e2e/report/input_mock_logdefault_flusher.json:/ilogtail/default_flusher.json
            - /apsarapangu/SSDCache1/ilogtail/test/e2e/report/config:/ilogtail/config/local
            - /:/logtail_host
            - /var/run/docker.sock:/var/run/docker.sock
            - /sys/:/sys/
version: "3.8"
